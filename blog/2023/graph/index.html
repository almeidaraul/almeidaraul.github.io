<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Duplicate graph trick (PT-BR) | Raul G. P. de Almeida</title> <meta name="author" content="Raul G. P. de Almeida"> <meta name="description" content="A simple graph trick to solve some SSSP problems"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%AE&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://almeidaraul.github.io/blog/2023/graph/"> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Duplicate graph trick (PT-BR)",
      "description": "A simple graph trick to solve some SSSP problems",
      "published": "November 23, 2023",
      "authors": [
        {
          "author": "Raul Almeida",
          "authorURL": "https://almeidaraul.github.io",
          "affiliations": [
            {
              "name": "DInf, UFPR",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="//"><span class="font-weight-bold">Raul </span>G. P. de Almeida</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Duplicate graph trick (PT-BR)</h1> <p>A simple graph trick to solve some SSSP problems</p> </d-title> <d-byline></d-byline> <d-article> <p>Estas são notas que acompanham a oficina que ministrei recentemente no Clube de Programação da UTFPR. Nela, eu apresentei o algoritmo de Dijkstra e um truque simples mas útil para resolver problemas no contexto de programação competitiva.</p> <p>Como o truque é simples, não faz mal adicionar a explicação do algoritmo de Dijkstra, mas você pode consultá-la em outros lugares como o CP-Algorithms. Os problemas apresentados serão três, sendo que os dois primeiros têm soluções mais simples (mas servem para motivos didáticos).</p> <h1 id="notação">Notação</h1> <p>Os termos arco e aresta são usados sem distinção, bem como distância, peso e custo.</p> <ul> <li>$n$: número de vértices</li> <li>$m$: número de arestas</li> <li>$E_{i,j}$: peso da aresta $(i, j)$</li> </ul> <h1 id="os-problemas-enunciados-resumidos">Os problemas (enunciados resumidos)</h1> <ul> <li> <a href="https://cses.fi/problemset/task/1195" rel="external nofollow noopener" target="_blank">Flight Discount (CSES)</a>: grafo direcionado, arcos com peso, $2 \leq n \leq 10^5$, $1 \leq m \leq 2\times10^5$. Encontre o menor caminho do vértice $1$ ao $n$ sendo que você pode escolher uma aresta $e$ qualquer e mudar seu peso $E_e$ para $\lfloor\frac{E_e}{2}\rfloor$ (só pode fazer isso uma vez)</li> <li> <a href="https://atcoder.jp/contests/abc325/tasks/abc325_e" rel="external nofollow noopener" target="_blank">Our clients, please wait a moment (AtCoder)</a>: grafo direcionado, arcos com peso, $2 \leq n \leq 1000$, $m = \frac{n(n-1)}{2}$. Encontre o menor caminho do vértice $1$ ao $n$ sendo que, para o caminho escolhido, todos os pesos $E_{i,j}$ valerão $E_{i,j}A$ até um ponto arbitrário, e a partir daí valerão $E_{i,j}B + C$. $1 \leq A, B, C \leq 10^6$</li> <li> <a href="https://codeforces.com/contest/1725/problem/M" rel="external nofollow noopener" target="_blank">Moving Both Hands (Codeforces)</a>: grafo direcionado, arcos com peso, $2 \leq n \leq 10^5$, $0 \leq m \leq 2\times10^5$. Para cada vértice $u &gt; 1$, encontre a menor distância para dois objetos se encontrarem seguindo os arcos, sendo que cada um se move de uma vez, um deles está no vértice $1$, e o outro está no vértice $u$.</li> </ul> <h1 id="dijkstra">Dijkstra</h1> <p>Nos três problemas nós usaremos o algoritmo de Dijkstra, então antes de irmos ao truque (e às soluções) vamos ver este algoritmo em detalhe.</p> <p>O algoritmo de Dijkstra resolve o problema de caminhos mínimos com origem única (Single-Source Shortest Paths, SSSP) para grafos com arestas de peso não-negativo. Neste problema, dado um vértice de origem, o objetivo é encontrar a menor distância para cada um dos outros vértices num caminho que começa na origem.</p> <p>Para as explicações a seguir, vamos fixar a origem no vértice $1$.</p> <h2 id="intuição">Intuição</h2> <p>A ideia intuitiva do algoritmo é: dado um vértice $u$ que com certeza tem caminho mínimo $w$, para cada aresta $(u, v)$, é possível que o menor caminho de $v$ tenha custo $w+E_{u,v}$. Isso equivaleria a dizer que o caminho mínimo de $v$ passa pela aresta $(u, v)$. Posto de outra forma: para cada cara com caminho mínimo definido, vamos tentar descobrir um novo menor caminho para seus vizinhos.</p> <h2 id="algoritmo">Algoritmo</h2> <p>Vamos guardar duas informações para cada vértice $v$: se ele já foi processado e qual a menor distância conhecida de $1$ até ele ($d_v$). Inicialmente, $d_1 = 0$ e $d_v = \infty \forall v \neq 1$.</p> <p>Para cada passo do algoritmo, vamos escolher o vértice $v$ com o menor $d_v$ entre aqueles que não foram processados ainda, e então processá-lo. Processar um vértice $v$ consiste em relaxar todas as arestas $(v, u)$ com a ideia apresentada na seção anterior: $d_u = \min(d_u, d_v+E_{v,u})$.</p> <p>É fácil ver que cada vértice só é processado uma vez, porque só processaremos um vértice que não foi processado. Mas por que é garantido que, ao processar um vértice, já temos o menor valor possível de $d_v$?</p> <h3 id="como-funciona">Como funciona</h3> <p>Digamos que seja possível que, após processar o vértice $v$, relaxemos alguma aresta que diminua o valor $d_v$.</p> <p>Se houvesse arestas negativas, poderia acontecer de inserirmos $v$ num ciclo com soma negativa, e aí seria possível tornar $d_v = -\infty$ (veja o grafo abaixo). No nosso problema, não há arestas negativas.</p> <div class="jekyll-diagrams diagrams mermaid"> <svg id="mermaid-1701356647929" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 317.140625px;" viewbox="0 0 317.140625 98"><style>#mermaid-1701356647929 .label{font-family:trebuchet ms,verdana,arial;color:#333}#mermaid-1701356647929 .node circle,#mermaid-1701356647929 .node ellipse,#mermaid-1701356647929 .node polygon,#mermaid-1701356647929 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1701356647929 .node.clickable{cursor:pointer}#mermaid-1701356647929 .arrowheadPath{fill:#333}#mermaid-1701356647929 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1701356647929 .edgeLabel{background-color:#e8e8e8}#mermaid-1701356647929 .cluster rect{fill:#ffffde!important;stroke:#aa3!important;stroke-width:1px!important}#mermaid-1701356647929 .cluster text{fill:#333}#mermaid-1701356647929 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:trebuchet ms,verdana,arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1701356647929 .actor{stroke:#ccf;fill:#ececff}#mermaid-1701356647929 text.actor{fill:#000;stroke:none}#mermaid-1701356647929 .actor-line{stroke:grey}#mermaid-1701356647929 .messageLine0{marker-end:"url(#arrowhead)"}#mermaid-1701356647929 .messageLine0,#mermaid-1701356647929 .messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#mermaid-1701356647929 #arrowhead{fill:#333}#mermaid-1701356647929 #crosshead path{fill:#333!important;stroke:#333!important}#mermaid-1701356647929 .messageText{fill:#333;stroke:none}#mermaid-1701356647929 .labelBox{stroke:#ccf;fill:#ececff}#mermaid-1701356647929 .labelText,#mermaid-1701356647929 .loopText{fill:#000;stroke:none}#mermaid-1701356647929 .loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#ccf}#mermaid-1701356647929 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1701356647929 .noteText{fill:#000;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:14px}#mermaid-1701356647929 .section{stroke:none;opacity:.2}#mermaid-1701356647929 .section0{fill:rgba(102,102,255,.49)}#mermaid-1701356647929 .section2{fill:#fff400}#mermaid-1701356647929 .section1,#mermaid-1701356647929 .section3{fill:#fff;opacity:.2}#mermaid-1701356647929 .sectionTitle0,#mermaid-1701356647929 .sectionTitle1,#mermaid-1701356647929 .sectionTitle2,#mermaid-1701356647929 .sectionTitle3{fill:#333}#mermaid-1701356647929 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1701356647929 .grid .tick{stroke:#d3d3d3;opacity:.3;shape-rendering:crispEdges}#mermaid-1701356647929 .grid path{stroke-width:0}#mermaid-1701356647929 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1701356647929 .task{stroke-width:2}#mermaid-1701356647929 .taskText{text-anchor:middle;font-size:11px}#mermaid-1701356647929 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1701356647929 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1701356647929 .taskText0,#mermaid-1701356647929 .taskText1,#mermaid-1701356647929 .taskText2,#mermaid-1701356647929 .taskText3{fill:#fff}#mermaid-1701356647929 .task0,#mermaid-1701356647929 .task1,#mermaid-1701356647929 .task2,#mermaid-1701356647929 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1701356647929 .taskTextOutside0,#mermaid-1701356647929 .taskTextOutside1,#mermaid-1701356647929 .taskTextOutside2,#mermaid-1701356647929 .taskTextOutside3{fill:#000}#mermaid-1701356647929 .active0,#mermaid-1701356647929 .active1,#mermaid-1701356647929 .active2,#mermaid-1701356647929 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1701356647929 .activeText0,#mermaid-1701356647929 .activeText1,#mermaid-1701356647929 .activeText2,#mermaid-1701356647929 .activeText3{fill:#000!important}#mermaid-1701356647929 .done0,#mermaid-1701356647929 .done1,#mermaid-1701356647929 .done2,#mermaid-1701356647929 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1701356647929 .doneText0,#mermaid-1701356647929 .doneText1,#mermaid-1701356647929 .doneText2,#mermaid-1701356647929 .doneText3{fill:#000!important}#mermaid-1701356647929 .crit0,#mermaid-1701356647929 .crit1,#mermaid-1701356647929 .crit2,#mermaid-1701356647929 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1701356647929 .activeCrit0,#mermaid-1701356647929 .activeCrit1,#mermaid-1701356647929 .activeCrit2,#mermaid-1701356647929 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1701356647929 .doneCrit0,#mermaid-1701356647929 .doneCrit1,#mermaid-1701356647929 .doneCrit2,#mermaid-1701356647929 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1701356647929 .activeCritText0,#mermaid-1701356647929 .activeCritText1,#mermaid-1701356647929 .activeCritText2,#mermaid-1701356647929 .activeCritText3,#mermaid-1701356647929 .doneCritText0,#mermaid-1701356647929 .doneCritText1,#mermaid-1701356647929 .doneCritText2,#mermaid-1701356647929 .doneCritText3{fill:#000!important}#mermaid-1701356647929 .titleText{text-anchor:middle;font-size:18px;fill:#000}
#mermaid-1701356647929 g.classGroup text{fill:#9370db;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:10px}#mermaid-1701356647929 g.classGroup rect{fill:#ececff;stroke:#9370db}#mermaid-1701356647929 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1701356647929 .classLabel .box{stroke:none;stroke-width:0;fill:#ececff;opacity:.5}#mermaid-1701356647929 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1701356647929 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1701356647929 #compositionEnd,#mermaid-1701356647929 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1701356647929 #aggregationEnd,#mermaid-1701356647929 #aggregationStart{fill:#ececff;stroke:#9370db;stroke-width:1}#mermaid-1701356647929 #dependencyEnd,#mermaid-1701356647929 #dependencyStart,#mermaid-1701356647929 #extensionEnd,#mermaid-1701356647929 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1701356647929 .branch-label,#mermaid-1701356647929 .commit-id,#mermaid-1701356647929 .commit-msg{fill:#d3d3d3;color:#d3d3d3}</style> <style>#mermaid-1701356647929{color:#000;font:normal normal 400 normal 16px / normal "Times New Roman"}</style> <g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M48.90625,57.019417475728154L77.90625,39L106.90625,39" marker-end="url(#arrowhead27)" style="fill:none"></path><defs><marker id="arrowhead27" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M135.8125,39L171.4765625,39L207.140625,39" marker-end="url(#arrowhead28)" style="fill:none"></path><defs><marker id="arrowhead28" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M235.140625,39L264.140625,39L293.140625,57.2093023255814" marker-end="url(#arrowhead29)" style="fill:none"></path><defs><marker id="arrowhead29" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M293.140625,74.79069767441861L264.140625,93L221.140625,93L171.4765625,93L121.359375,93L77.90625,93L48.90625,74.98058252427184" marker-end="url(#arrowhead30)" style="fill:none"></path><defs><marker id="arrowhead30" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform="translate(77.90625,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">2</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(171.4765625,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">2</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(264.140625,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(171.4765625,93)"><g transform="translate(-10.6640625,-9)" class="label"><foreignobject width="21.328125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">-10</span></div></foreignobject></g></g></g><g class="nodes"><g class="node" id="1" transform="translate(34.453125,66)" style="opacity: 1;"><rect rx="0" ry="0" x="-14.453125" y="-19" width="28.90625" height="38"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">1</div></foreignobject></g></g></g><g class="node" id="b" transform="translate(121.359375,39)" style="opacity: 1;"><rect rx="0" ry="0" x="-14.453125" y="-19" width="28.90625" height="38"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">b</div></foreignobject></g></g></g><g class="node" id="v" transform="translate(221.140625,39)" style="opacity: 1;"><rect rx="0" ry="0" x="-14" y="-19" width="28" height="38"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4,-9)"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">v</div></foreignobject></g></g></g><g class="node" id="x" transform="translate(307.140625,66)" style="opacity: 1;"><rect rx="0" ry="0" x="-14" y="-19" width="28" height="38"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4,-9)"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">x</div></foreignobject></g></g></g></g></g></g></svg> </div> <p>Como não há arestas negativas, o único jeito é se encontrarmos algum vértice $u$ com $d_u &lt; d_v$, onde há um caminho de $u$ até $v$ com peso $x$ tal que $d_u + x &lt; d_v$. No entanto, como processamos sempre o vértice com menor distância primeiro, e como $d_u &lt; d_v$, nós teríamos processado $u$ antes de $v$.</p> <p>Portanto, ao processar o vértice $v$, <strong>já conhecemos o menor valor possível para $d_v$.</strong></p> <h3 id="complexidade---observações">Complexidade - observações</h3> <p>Agora, qual será a complexidade desse algoritmo? Começaremos por algumas observações.</p> <h4 id="observação-1-cada-vértice-é-processado-uma-vez">Observação 1: cada vértice é processado uma vez</h4> <p>Cada vértice é processado apenas uma vez, porque não processamos vértices que já foram processados. Isso implica em um termo $\mathcal{O}(n)$ em algum lugar na complexidade final.</p> <h4 id="observação-2-cada-aresta-é-relaxada-uma-vez">Observação 2: cada aresta é relaxada uma vez</h4> <p>Nós relaxaremos uma aresta $(u, v)$ sempre que processarmos o vértice de origem $u$, ou seja, uma vez. Isso implica em um termo $+\mathcal{O}(m)$ em algum lugar na complexidade final (separado do termo anterior).</p> <p>Ignorando as complexidades de escolher o próximo vértice a processar e de relaxar uma aresta, temos uma complexidade de $\mathcal{O}(n+m)$.</p> <h4 id="complexidade-e-código-para-grafos-densos">Complexidade e código para grafos densos</h4> <p>Em grafos densos, o número de arestas é próximo do máximo ($\frac{n(n-1)}{2}$). Se guardamos em um vetor booleano $m$ quais vértices já foram processados, podemos a cada iteração do algoritmo buscar o próximo vértice a ser processado em $\mathcal{O}(n)$, relaxando cada aresta em $\mathcal{O}(1)$. Isso significa uma complexidade $\mathcal{O}(n^2 + m) = \mathcal{O}(n^2)$. Para grafos densos, essa complexidade é ótima. Abaixo deixo uma implementação do algoritmo nesse caso:</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">ii</span> <span class="o">=</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ii</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mh">0x3f3f3f3f</span><span class="p">),</span> <span class="n">m</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
	<span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// escolhe o próximo</span>
		<span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">||</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
				<span class="n">v</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
		<span class="c1">// processa</span>
		<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">]</span><span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
			<span class="c1">// relaxa aresta (v, u)</span>
			<span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h4 id="complexidade-e-código-para-grafos-esparsos">Complexidade e código para grafos esparsos</h4> <p>Quando o número de arestas é muito menor que o máximo possível, existe uma variação com desempenho melhor. O que vamos fazer é guardar em uma estrutura que permita inserção de valores e remoção de mínimo em tempo logarítmico, e guardar nela pares $(d_v, v)$.</p> <p>A melhoria dessa variação é que a seleção do próximo vértice a processar terá custo logarítmico, já que basta selecionar o menor par na estrutura.</p> <p>Ao mesmo tempo, relaxar uma aresta deixará de ser constante, porque ao encontrar um peso menor para o vértice $u$ nós teremos de adicioná-lo à estrutura em tempo logarítmico.</p> <p>Com essa alteração, a complexidade do algoritmo passa a ser $\mathcal{O}(n\log n + m\log n)$, que é muito melhor que a anterior no caso de grafos esparsos.</p> <p>A implementação abaixo usa uma fila de prioridade, mas outras estruturas apresentam a mesma complexidade. Com uma <em>fibonacci heap</em> é possível atingir tempo constante na inserção e logarítmico na remoção, mas como ela é muito mais difícil de implementar, não é tão adequada para programação competitiva.</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">ii</span> <span class="o">=</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ii</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mh">0x3f3f3f3f</span><span class="p">);</span>
	<span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">ii</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ii</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span><span class="n">ii</span><span class="o">&gt;&gt;</span> <span class="n">pq</span><span class="p">;</span>
	<span class="n">pq</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">pq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
		<span class="c1">// escolhe o próximo</span>
		<span class="k">auto</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">();</span> <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">!=</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="c1">// descarta pares desatualizados</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="c1">// processa</span>
		<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">]</span><span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
			<span class="c1">// relaxa aresta (v, u)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">w</span><span class="o">+</span><span class="n">x</span><span class="p">)</span>
				<span class="n">pq</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="n">x</span><span class="p">),</span> <span class="n">u</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h1 id="truque-do-grafo-duplicado">Truque do grafo duplicado</h1> <p>Agora vamos ao truque que é o ponto central disso tudo. É uma técnica de modelagem bem simples, que só merece um nome porque essa página precisava de um título.</p> <p>A técnica consiste em duplicar o grafo, fazendo com que cada vértice e aresta tenha uma versão “original” e uma “modificada”. A modificação depende do problema.</p> <p>Além dos vértices e arestas duplicadas, existirão arcos de transição entre o “grafo original” e o “grafo duplicado”. Isso vai fazer mais sentido quando olharmos para os problemas, mas essencialmente esses arcos de transição representam decisões irreversíveis sobre a maneira como se caminha no grafo: a versão duplicada do grafo é onde você caminha depois de tomar essas decisões.</p> <h2 id="soluções-com-o-truque">Soluções com o truque</h2> <h3 id="flight-discount">Flight Discount</h3> <p>Esse é o problema mais simples, com uma solução muito mais simples que essa, mas é bem fácil de pensar com esse truque. Aqui, a versão duplicada do grafo vai ser igual ao grafo original, e os arcos de transição serão os arcos com o desconto aplicado. Dessa maneira, o desconto só poderá ser aplicado uma vez em um caminho pelo grafo, porque não existem arcos de retorno para a parte original.</p> <p>Considere este grafo de exemplo:</p> <div class="jekyll-diagrams diagrams mermaid"> <svg id="mermaid-1701356648327" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 246px;" viewbox="0 0 246 54"><style>#mermaid-1701356648327 .label{font-family:trebuchet ms,verdana,arial;color:#333}#mermaid-1701356648327 .node circle,#mermaid-1701356648327 .node ellipse,#mermaid-1701356648327 .node polygon,#mermaid-1701356648327 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1701356648327 .node.clickable{cursor:pointer}#mermaid-1701356648327 .arrowheadPath{fill:#333}#mermaid-1701356648327 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1701356648327 .edgeLabel{background-color:#e8e8e8}#mermaid-1701356648327 .cluster rect{fill:#ffffde!important;stroke:#aa3!important;stroke-width:1px!important}#mermaid-1701356648327 .cluster text{fill:#333}#mermaid-1701356648327 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:trebuchet ms,verdana,arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1701356648327 .actor{stroke:#ccf;fill:#ececff}#mermaid-1701356648327 text.actor{fill:#000;stroke:none}#mermaid-1701356648327 .actor-line{stroke:grey}#mermaid-1701356648327 .messageLine0{marker-end:"url(#arrowhead)"}#mermaid-1701356648327 .messageLine0,#mermaid-1701356648327 .messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#mermaid-1701356648327 #arrowhead{fill:#333}#mermaid-1701356648327 #crosshead path{fill:#333!important;stroke:#333!important}#mermaid-1701356648327 .messageText{fill:#333;stroke:none}#mermaid-1701356648327 .labelBox{stroke:#ccf;fill:#ececff}#mermaid-1701356648327 .labelText,#mermaid-1701356648327 .loopText{fill:#000;stroke:none}#mermaid-1701356648327 .loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#ccf}#mermaid-1701356648327 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1701356648327 .noteText{fill:#000;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:14px}#mermaid-1701356648327 .section{stroke:none;opacity:.2}#mermaid-1701356648327 .section0{fill:rgba(102,102,255,.49)}#mermaid-1701356648327 .section2{fill:#fff400}#mermaid-1701356648327 .section1,#mermaid-1701356648327 .section3{fill:#fff;opacity:.2}#mermaid-1701356648327 .sectionTitle0,#mermaid-1701356648327 .sectionTitle1,#mermaid-1701356648327 .sectionTitle2,#mermaid-1701356648327 .sectionTitle3{fill:#333}#mermaid-1701356648327 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1701356648327 .grid .tick{stroke:#d3d3d3;opacity:.3;shape-rendering:crispEdges}#mermaid-1701356648327 .grid path{stroke-width:0}#mermaid-1701356648327 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1701356648327 .task{stroke-width:2}#mermaid-1701356648327 .taskText{text-anchor:middle;font-size:11px}#mermaid-1701356648327 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1701356648327 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1701356648327 .taskText0,#mermaid-1701356648327 .taskText1,#mermaid-1701356648327 .taskText2,#mermaid-1701356648327 .taskText3{fill:#fff}#mermaid-1701356648327 .task0,#mermaid-1701356648327 .task1,#mermaid-1701356648327 .task2,#mermaid-1701356648327 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1701356648327 .taskTextOutside0,#mermaid-1701356648327 .taskTextOutside1,#mermaid-1701356648327 .taskTextOutside2,#mermaid-1701356648327 .taskTextOutside3{fill:#000}#mermaid-1701356648327 .active0,#mermaid-1701356648327 .active1,#mermaid-1701356648327 .active2,#mermaid-1701356648327 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1701356648327 .activeText0,#mermaid-1701356648327 .activeText1,#mermaid-1701356648327 .activeText2,#mermaid-1701356648327 .activeText3{fill:#000!important}#mermaid-1701356648327 .done0,#mermaid-1701356648327 .done1,#mermaid-1701356648327 .done2,#mermaid-1701356648327 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1701356648327 .doneText0,#mermaid-1701356648327 .doneText1,#mermaid-1701356648327 .doneText2,#mermaid-1701356648327 .doneText3{fill:#000!important}#mermaid-1701356648327 .crit0,#mermaid-1701356648327 .crit1,#mermaid-1701356648327 .crit2,#mermaid-1701356648327 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1701356648327 .activeCrit0,#mermaid-1701356648327 .activeCrit1,#mermaid-1701356648327 .activeCrit2,#mermaid-1701356648327 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1701356648327 .doneCrit0,#mermaid-1701356648327 .doneCrit1,#mermaid-1701356648327 .doneCrit2,#mermaid-1701356648327 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1701356648327 .activeCritText0,#mermaid-1701356648327 .activeCritText1,#mermaid-1701356648327 .activeCritText2,#mermaid-1701356648327 .activeCritText3,#mermaid-1701356648327 .doneCritText0,#mermaid-1701356648327 .doneCritText1,#mermaid-1701356648327 .doneCritText2,#mermaid-1701356648327 .doneCritText3{fill:#000!important}#mermaid-1701356648327 .titleText{text-anchor:middle;font-size:18px;fill:#000}
#mermaid-1701356648327 g.classGroup text{fill:#9370db;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:10px}#mermaid-1701356648327 g.classGroup rect{fill:#ececff;stroke:#9370db}#mermaid-1701356648327 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1701356648327 .classLabel .box{stroke:none;stroke-width:0;fill:#ececff;opacity:.5}#mermaid-1701356648327 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1701356648327 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1701356648327 #compositionEnd,#mermaid-1701356648327 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1701356648327 #aggregationEnd,#mermaid-1701356648327 #aggregationStart{fill:#ececff;stroke:#9370db;stroke-width:1}#mermaid-1701356648327 #dependencyEnd,#mermaid-1701356648327 #dependencyStart,#mermaid-1701356648327 #extensionEnd,#mermaid-1701356648327 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1701356648327 .branch-label,#mermaid-1701356648327 .commit-id,#mermaid-1701356648327 .commit-msg{fill:#d3d3d3;color:#d3d3d3}</style> <style>#mermaid-1701356648327{color:#000;font:normal normal 400 normal 16px / normal "Times New Roman"}</style> <g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M58,39L87,39L116,39" marker-end="url(#arrowhead14)" style="fill:none"></path><defs><marker id="arrowhead14" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M154,39L183,39L212,39" marker-end="url(#arrowhead15)" style="fill:none"></path><defs><marker id="arrowhead15" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform="translate(87,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">7</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(183,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">4</span></div></foreignobject></g></g></g><g class="nodes"><g class="node" id="id1" transform="translate(39,39)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">1</div></foreignobject></g></g></g><g class="node" id="id2" transform="translate(135,39)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">2</div></foreignobject></g></g></g><g class="node" id="id3" transform="translate(231,39)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">3</div></foreignobject></g></g></g></g></g></g></svg> </div> <p>Com o truque aplicado, teríamos o grafo abaixo. A parte de cima é idêntica ao grafo original, bem como a parte de baixo. Os arcos que levam de cima para baixo correspondem ao desconto aplicado. Note que não há arcos de baixo para cima.</p> <div class="jekyll-diagrams diagrams mermaid"> <svg id="mermaid-1701356648704" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 320.9375px;" viewbox="0 0 320.9375 218"><style>#mermaid-1701356648704 .label{font-family:trebuchet ms,verdana,arial;color:#333}#mermaid-1701356648704 .node circle,#mermaid-1701356648704 .node ellipse,#mermaid-1701356648704 .node polygon,#mermaid-1701356648704 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1701356648704 .node.clickable{cursor:pointer}#mermaid-1701356648704 .arrowheadPath{fill:#333}#mermaid-1701356648704 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1701356648704 .edgeLabel{background-color:#e8e8e8}#mermaid-1701356648704 .cluster rect{fill:#ffffde!important;stroke:#aa3!important;stroke-width:1px!important}#mermaid-1701356648704 .cluster text{fill:#333}#mermaid-1701356648704 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:trebuchet ms,verdana,arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1701356648704 .actor{stroke:#ccf;fill:#ececff}#mermaid-1701356648704 text.actor{fill:#000;stroke:none}#mermaid-1701356648704 .actor-line{stroke:grey}#mermaid-1701356648704 .messageLine0{marker-end:"url(#arrowhead)"}#mermaid-1701356648704 .messageLine0,#mermaid-1701356648704 .messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#mermaid-1701356648704 #arrowhead{fill:#333}#mermaid-1701356648704 #crosshead path{fill:#333!important;stroke:#333!important}#mermaid-1701356648704 .messageText{fill:#333;stroke:none}#mermaid-1701356648704 .labelBox{stroke:#ccf;fill:#ececff}#mermaid-1701356648704 .labelText,#mermaid-1701356648704 .loopText{fill:#000;stroke:none}#mermaid-1701356648704 .loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#ccf}#mermaid-1701356648704 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1701356648704 .noteText{fill:#000;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:14px}#mermaid-1701356648704 .section{stroke:none;opacity:.2}#mermaid-1701356648704 .section0{fill:rgba(102,102,255,.49)}#mermaid-1701356648704 .section2{fill:#fff400}#mermaid-1701356648704 .section1,#mermaid-1701356648704 .section3{fill:#fff;opacity:.2}#mermaid-1701356648704 .sectionTitle0,#mermaid-1701356648704 .sectionTitle1,#mermaid-1701356648704 .sectionTitle2,#mermaid-1701356648704 .sectionTitle3{fill:#333}#mermaid-1701356648704 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1701356648704 .grid .tick{stroke:#d3d3d3;opacity:.3;shape-rendering:crispEdges}#mermaid-1701356648704 .grid path{stroke-width:0}#mermaid-1701356648704 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1701356648704 .task{stroke-width:2}#mermaid-1701356648704 .taskText{text-anchor:middle;font-size:11px}#mermaid-1701356648704 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1701356648704 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1701356648704 .taskText0,#mermaid-1701356648704 .taskText1,#mermaid-1701356648704 .taskText2,#mermaid-1701356648704 .taskText3{fill:#fff}#mermaid-1701356648704 .task0,#mermaid-1701356648704 .task1,#mermaid-1701356648704 .task2,#mermaid-1701356648704 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1701356648704 .taskTextOutside0,#mermaid-1701356648704 .taskTextOutside1,#mermaid-1701356648704 .taskTextOutside2,#mermaid-1701356648704 .taskTextOutside3{fill:#000}#mermaid-1701356648704 .active0,#mermaid-1701356648704 .active1,#mermaid-1701356648704 .active2,#mermaid-1701356648704 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1701356648704 .activeText0,#mermaid-1701356648704 .activeText1,#mermaid-1701356648704 .activeText2,#mermaid-1701356648704 .activeText3{fill:#000!important}#mermaid-1701356648704 .done0,#mermaid-1701356648704 .done1,#mermaid-1701356648704 .done2,#mermaid-1701356648704 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1701356648704 .doneText0,#mermaid-1701356648704 .doneText1,#mermaid-1701356648704 .doneText2,#mermaid-1701356648704 .doneText3{fill:#000!important}#mermaid-1701356648704 .crit0,#mermaid-1701356648704 .crit1,#mermaid-1701356648704 .crit2,#mermaid-1701356648704 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1701356648704 .activeCrit0,#mermaid-1701356648704 .activeCrit1,#mermaid-1701356648704 .activeCrit2,#mermaid-1701356648704 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1701356648704 .doneCrit0,#mermaid-1701356648704 .doneCrit1,#mermaid-1701356648704 .doneCrit2,#mermaid-1701356648704 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1701356648704 .activeCritText0,#mermaid-1701356648704 .activeCritText1,#mermaid-1701356648704 .activeCritText2,#mermaid-1701356648704 .activeCritText3,#mermaid-1701356648704 .doneCritText0,#mermaid-1701356648704 .doneCritText1,#mermaid-1701356648704 .doneCritText2,#mermaid-1701356648704 .doneCritText3{fill:#000!important}#mermaid-1701356648704 .titleText{text-anchor:middle;font-size:18px;fill:#000}
#mermaid-1701356648704 g.classGroup text{fill:#9370db;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:10px}#mermaid-1701356648704 g.classGroup rect{fill:#ececff;stroke:#9370db}#mermaid-1701356648704 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1701356648704 .classLabel .box{stroke:none;stroke-width:0;fill:#ececff;opacity:.5}#mermaid-1701356648704 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1701356648704 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1701356648704 #compositionEnd,#mermaid-1701356648704 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1701356648704 #aggregationEnd,#mermaid-1701356648704 #aggregationStart{fill:#ececff;stroke:#9370db;stroke-width:1}#mermaid-1701356648704 #dependencyEnd,#mermaid-1701356648704 #dependencyStart,#mermaid-1701356648704 #extensionEnd,#mermaid-1701356648704 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1701356648704 .branch-label,#mermaid-1701356648704 .commit-id,#mermaid-1701356648704 .commit-msg{fill:#d3d3d3;color:#d3d3d3}</style> <style>#mermaid-1701356648704{color:#000;font:normal normal 400 normal 16px / normal "Times New Roman"}</style> <g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M57.273790808414596,71.79725365885457L105.734375,58L153.46875,58" marker-end="url(#arrowhead22)" style="fill:none"></path><defs><marker id="arrowhead22" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M190.7425408084146,52.797253658854565L239.203125,39L286.9375,39" marker-end="url(#arrowhead23)" style="fill:none"></path><defs><marker id="arrowhead23" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M58,203L105.734375,203L154.1949591915854,189.20274634114543" marker-end="url(#arrowhead24)" style="fill:none"></path><defs><marker id="arrowhead24" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M191.46875,184L239.203125,184L287.6637091915854,170.20274634114543" marker-end="url(#arrowhead25)" style="fill:none"></path><defs><marker id="arrowhead25" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M52.816030602950036,90.04290222221834L105.734375,140L156.6062896554785,173.541398190079" marker-end="url(#arrowhead26)" style="fill:none"></path><defs><marker id="arrowhead26" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M188.3312103445215,68.45860180992099L239.203125,102L292.12146939704996,151.95709777778166" marker-end="url(#arrowhead27)" style="fill:none"></path><defs><marker id="arrowhead27" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform="translate(105.734375,58)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">7</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(239.203125,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">4</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(105.734375,203)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">7</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(239.203125,184)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">4</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(105.734375,140)"><g transform="translate(-22.734375,-9)" class="label"><foreignobject width="45.46875" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">7/2 = 3</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(239.203125,102)"><g transform="translate(-22.734375,-9)" class="label"><foreignobject width="45.46875" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">4/2 = 2</span></div></foreignobject></g></g></g><g class="nodes"><g class="node" id="id1" transform="translate(39,77)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">1</div></foreignobject></g></g></g><g class="node" id="id2" transform="translate(172.46875,58)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">2</div></foreignobject></g></g></g><g class="node" id="id3" transform="translate(305.9375,39)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">3</div></foreignobject></g></g></g><g class="node" id="id11" transform="translate(39,203)" style="opacity: 1;"><circle x="-15.9765625" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.9765625,-9)"><foreignobject width="11.953125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">1'</div></foreignobject></g></g></g><g class="node" id="id21" transform="translate(172.46875,184)" style="opacity: 1;"><circle x="-15.9765625" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.9765625,-9)"><foreignobject width="11.953125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">2'</div></foreignobject></g></g></g><g class="node" id="id31" transform="translate(305.9375,165)" style="opacity: 1;"><circle x="-15.9765625" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.9765625,-9)"><foreignobject width="11.953125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">3'</div></foreignobject></g></g></g></g></g></g></svg> </div> <p>A implementação dessa solução é muito simples. O código do Dijkstra é o mesmo, e a construção do grafo é levemente diferente:</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">;</span>
  <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">a</span> <span class="o">&gt;&gt;</span> <span class="n">b</span> <span class="o">&gt;&gt;</span> <span class="n">c</span><span class="p">;</span>
  <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>  <span class="c1">// arco conforme na entrada</span>
  <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="o">+</span><span class="n">n</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">b</span><span class="o">+</span><span class="n">n</span><span class="p">);</span>  <span class="c1">// arco duplicado (parte de "baixo" do grafo)</span>
  <span class="n">g</span><span class="p">[</span><span class="n">a</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">c</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">b</span><span class="o">+</span><span class="n">n</span><span class="p">);</span>  <span class="c1">// arco de transição (desconto)</span>
<span class="p">}</span>
</code></pre></div></div> <p>Neste código, nós reservamos os vértices $1 \leq v \leq n$ para o grafo “original”, e os vértices $n+1 \leq v^{\prime} \leq 2n$ para o grafo duplicado.</p> <h3 id="our-clients-please-wait-a-moment">Our clients, please wait a moment</h3> <p>A ideia aqui é muito parecida com a do problema anterior. Dessa vez os arcos de transição terão custo $0$, mas os pesos dos arcos serão diferentes dependendo de em qual parte do grafo você está. O grafo original corresponde ao prefixo do caminho, que é de carro, e o grafo duplicado corresponde ao sufixo, que é de trem.</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
    <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">d</span><span class="p">;</span>
    <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="n">j</span><span class="p">);</span>  <span class="c1">// custo de carro: A*D(i,j)</span>
    <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">);</span>  <span class="c1">// transição: custo 0</span>
    <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">d</span><span class="o">*</span><span class="n">b</span><span class="o">+</span><span class="n">c</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="n">n</span><span class="p">);</span>  <span class="c1">// custo de trem: B*D(i,j) + C</span>
  <span class="p">}</span>
</code></pre></div></div> <h3 id="moving-both-hands">Moving Both Hands</h3> <p>Neste problema vamos usar uma ideia mais complicada, mas ainda baseada no truque do grafo duplicado. A primeira coisa que queremos ignorar na nossa modelagem é que tem dois objetos distintos se movendo.</p> <p>Observe que, em termos de custo, a mão esquerda e a mão direita se encontrarem num ponto X é a mesma coisa que a mão esquerda fazer o mesmo caminho até o ponto X, depois fazer o caminho contrário da mão direita até o ponto de origem desta.</p> <p>Isto é, no caminho ótimo para as duas mãos se encontrarem (nesta visualização na qual a mão direita não se move), a mão esquerda vai caminhar pelo grafo normalmente até um ponto arbitrário do caminho, e então passará a caminhar pelo grafo com arcos invertidos pelo resto do caminho.</p> <p>Agora a modelagem com o truque fica praticamente pronta: o grafo duplicado será o grafo transposto, e os arcos de transição levarão cada vértice $v$ ao vértice $v^{\prime}$ com custo $0$.</p> <div class="jekyll-diagrams diagrams mermaid"> <svg id="mermaid-1701356649105" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 342px;" viewbox="0 0 342 180"><style>#mermaid-1701356649105 .label{font-family:trebuchet ms,verdana,arial;color:#333}#mermaid-1701356649105 .node circle,#mermaid-1701356649105 .node ellipse,#mermaid-1701356649105 .node polygon,#mermaid-1701356649105 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1701356649105 .node.clickable{cursor:pointer}#mermaid-1701356649105 .arrowheadPath{fill:#333}#mermaid-1701356649105 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1701356649105 .edgeLabel{background-color:#e8e8e8}#mermaid-1701356649105 .cluster rect{fill:#ffffde!important;stroke:#aa3!important;stroke-width:1px!important}#mermaid-1701356649105 .cluster text{fill:#333}#mermaid-1701356649105 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:trebuchet ms,verdana,arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1701356649105 .actor{stroke:#ccf;fill:#ececff}#mermaid-1701356649105 text.actor{fill:#000;stroke:none}#mermaid-1701356649105 .actor-line{stroke:grey}#mermaid-1701356649105 .messageLine0{marker-end:"url(#arrowhead)"}#mermaid-1701356649105 .messageLine0,#mermaid-1701356649105 .messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#mermaid-1701356649105 #arrowhead{fill:#333}#mermaid-1701356649105 #crosshead path{fill:#333!important;stroke:#333!important}#mermaid-1701356649105 .messageText{fill:#333;stroke:none}#mermaid-1701356649105 .labelBox{stroke:#ccf;fill:#ececff}#mermaid-1701356649105 .labelText,#mermaid-1701356649105 .loopText{fill:#000;stroke:none}#mermaid-1701356649105 .loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#ccf}#mermaid-1701356649105 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1701356649105 .noteText{fill:#000;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:14px}#mermaid-1701356649105 .section{stroke:none;opacity:.2}#mermaid-1701356649105 .section0{fill:rgba(102,102,255,.49)}#mermaid-1701356649105 .section2{fill:#fff400}#mermaid-1701356649105 .section1,#mermaid-1701356649105 .section3{fill:#fff;opacity:.2}#mermaid-1701356649105 .sectionTitle0,#mermaid-1701356649105 .sectionTitle1,#mermaid-1701356649105 .sectionTitle2,#mermaid-1701356649105 .sectionTitle3{fill:#333}#mermaid-1701356649105 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1701356649105 .grid .tick{stroke:#d3d3d3;opacity:.3;shape-rendering:crispEdges}#mermaid-1701356649105 .grid path{stroke-width:0}#mermaid-1701356649105 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1701356649105 .task{stroke-width:2}#mermaid-1701356649105 .taskText{text-anchor:middle;font-size:11px}#mermaid-1701356649105 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1701356649105 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1701356649105 .taskText0,#mermaid-1701356649105 .taskText1,#mermaid-1701356649105 .taskText2,#mermaid-1701356649105 .taskText3{fill:#fff}#mermaid-1701356649105 .task0,#mermaid-1701356649105 .task1,#mermaid-1701356649105 .task2,#mermaid-1701356649105 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1701356649105 .taskTextOutside0,#mermaid-1701356649105 .taskTextOutside1,#mermaid-1701356649105 .taskTextOutside2,#mermaid-1701356649105 .taskTextOutside3{fill:#000}#mermaid-1701356649105 .active0,#mermaid-1701356649105 .active1,#mermaid-1701356649105 .active2,#mermaid-1701356649105 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1701356649105 .activeText0,#mermaid-1701356649105 .activeText1,#mermaid-1701356649105 .activeText2,#mermaid-1701356649105 .activeText3{fill:#000!important}#mermaid-1701356649105 .done0,#mermaid-1701356649105 .done1,#mermaid-1701356649105 .done2,#mermaid-1701356649105 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1701356649105 .doneText0,#mermaid-1701356649105 .doneText1,#mermaid-1701356649105 .doneText2,#mermaid-1701356649105 .doneText3{fill:#000!important}#mermaid-1701356649105 .crit0,#mermaid-1701356649105 .crit1,#mermaid-1701356649105 .crit2,#mermaid-1701356649105 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1701356649105 .activeCrit0,#mermaid-1701356649105 .activeCrit1,#mermaid-1701356649105 .activeCrit2,#mermaid-1701356649105 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1701356649105 .doneCrit0,#mermaid-1701356649105 .doneCrit1,#mermaid-1701356649105 .doneCrit2,#mermaid-1701356649105 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1701356649105 .activeCritText0,#mermaid-1701356649105 .activeCritText1,#mermaid-1701356649105 .activeCritText2,#mermaid-1701356649105 .activeCritText3,#mermaid-1701356649105 .doneCritText0,#mermaid-1701356649105 .doneCritText1,#mermaid-1701356649105 .doneCritText2,#mermaid-1701356649105 .doneCritText3{fill:#000!important}#mermaid-1701356649105 .titleText{text-anchor:middle;font-size:18px;fill:#000}
#mermaid-1701356649105 g.classGroup text{fill:#9370db;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:10px}#mermaid-1701356649105 g.classGroup rect{fill:#ececff;stroke:#9370db}#mermaid-1701356649105 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1701356649105 .classLabel .box{stroke:none;stroke-width:0;fill:#ececff;opacity:.5}#mermaid-1701356649105 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1701356649105 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1701356649105 #compositionEnd,#mermaid-1701356649105 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1701356649105 #aggregationEnd,#mermaid-1701356649105 #aggregationStart{fill:#ececff;stroke:#9370db;stroke-width:1}#mermaid-1701356649105 #dependencyEnd,#mermaid-1701356649105 #dependencyStart,#mermaid-1701356649105 #extensionEnd,#mermaid-1701356649105 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1701356649105 .branch-label,#mermaid-1701356649105 .commit-id,#mermaid-1701356649105 .commit-msg{fill:#d3d3d3;color:#d3d3d3}</style> <style>#mermaid-1701356649105{color:#000;font:normal normal 400 normal 16px / normal "Times New Roman"}</style> <g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M53.00592866381409,114.83876794182959L87,146L116,146" marker-end="url(#arrowhead28)" style="fill:none"></path><defs><marker id="arrowhead28" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M152.66632564835416,152.99292056914018L183,165L212,165" marker-end="url(#arrowhead29)" style="fill:none"></path><defs><marker id="arrowhead29" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M154,39L183,39L213.33367435164584,51.00707943085981" marker-end="url(#arrowhead30)" style="fill:none"></path><defs><marker id="arrowhead30" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M250,58L279,58L312.9940713361859,89.16123205817041" marker-end="url(#arrowhead31)" style="fill:none"></path><defs><marker id="arrowhead31" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M50.514821089994264,86.88679731938252L87,39L116,39" marker-end="url(#arrowhead32)" style="fill:none"></path><defs><marker id="arrowhead32" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M149.00592866381407,133.1612320581704L183,102L216.99407133618593,70.83876794182959" marker-end="url(#arrowhead33)" style="fill:none"></path><defs><marker id="arrowhead33" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M250,165L279,165L315.48517891000574,117.11320268061748" marker-end="url(#arrowhead34)" style="fill:none"></path><defs><marker id="arrowhead34" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform="translate(87,146)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">7</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(183,165)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">4</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(183,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">7</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(279,58)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">4</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(87,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(183,102)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">0</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(279,165)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">0</span></div></foreignobject></g></g></g><g class="nodes"><g class="node" id="id1" transform="translate(39,102)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">1</div></foreignobject></g></g></g><g class="node" id="id2" transform="translate(135,146)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">2</div></foreignobject></g></g></g><g class="node" id="id3" transform="translate(231,165)" style="opacity: 1;"><circle x="-14.453125" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">3</div></foreignobject></g></g></g><g class="node" id="id11" transform="translate(135,39)" style="opacity: 1;"><circle x="-15.9765625" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.9765625,-9)"><foreignobject width="11.953125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">1'</div></foreignobject></g></g></g><g class="node" id="id21" transform="translate(231,58)" style="opacity: 1;"><circle x="-15.9765625" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.9765625,-9)"><foreignobject width="11.953125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">2'</div></foreignobject></g></g></g><g class="node" id="id31" transform="translate(327,102)" style="opacity: 1;"><circle x="-15.9765625" y="-19" r="19"></circle><g class="label" transform="translate(0,0)"><g transform="translate(-5.9765625,-9)"><foreignobject width="11.953125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">3'</div></foreignobject></g></g></g></g></g></g></svg> </div> <p>Construção do grafo:</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">while</span> <span class="p">(</span><span class="n">m</span><span class="o">--</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">int</span> <span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">;</span>
  <span class="n">cin</span> <span class="o">&gt;&gt;</span> <span class="n">u</span> <span class="o">&gt;&gt;</span> <span class="n">v</span> <span class="o">&gt;&gt;</span> <span class="n">w</span><span class="p">;</span>
  <span class="n">u</span><span class="o">--</span><span class="p">,</span> <span class="n">v</span><span class="o">--</span><span class="p">;</span>
  <span class="n">g</span><span class="p">[</span><span class="n">u</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">);</span>
  <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">].</span><span class="n">emplace_back</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">u</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="observação-obtendo-a-resposta">Observação: obtendo a resposta</h3> <p>Note que para encontrar a menor distância até um vértice $v$, em qualquer um dos problemas mencionados, você deverá selecionar a distância mínima entre $d_v$ e $d_{v^{\prime}}$.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="sticky-bottom mt-5"> <div class="container"> © Copyright 2023 Raul G. P. de Almeida. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>