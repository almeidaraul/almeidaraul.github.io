<!DOCTYPE html> <html> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Duplicate graph trick (PT-BR) | Raul G. P. de Almeida</title> <meta name="author" content="Raul G. P. de Almeida"> <meta name="description" content="A simple graph trick to solve some SSSP problems"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.21.4/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%A7%AE&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://almeidaraul.github.io/blog/2023/graph/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> </head> <body> <d-front-matter> <script async type="text/json">{
      "title": "Duplicate graph trick (PT-BR)",
      "description": "A simple graph trick to solve some SSSP problems",
      "published": "November 23, 2023",
      "authors": [
        {
          "author": "Raul Almeida",
          "authorURL": "https://almeidaraul.github.io",
          "affiliations": [
            {
              "name": "DInf, UFPR",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="//"><span class="font-weight-bold">Raul¬†</span>G. P.¬†de Almeida</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="post distill"> <d-title> <h1>Duplicate graph trick (PT-BR)</h1> <p>A simple graph trick to solve some SSSP problems</p> </d-title> <d-byline></d-byline> <d-article> <p>üöß em constru√ß√£o</p> <p>Estas s√£o notas que acompanham a oficina que ministrei recentemente no Clube de Programa√ß√£o da UTFPR. Nela, eu apresentei o algoritmo de Dijkstra e um truque simples mas √∫til para resolver problemas no contexto de programa√ß√£o competitiva.</p> <p>Como o truque √© simples, n√£o faz mal adicionar a explica√ß√£o do algoritmo de Dijkstra, mas voc√™ pode consult√°-la em outros lugares como o CP-Algorithms. Os problemas apresentados ser√£o tr√™s, sendo que os dois primeiros t√™m solu√ß√µes mais simples (mas servem para motivos did√°ticos).</p> <h1 id="nota√ß√£o">Nota√ß√£o</h1> <p>Os termos arco e aresta s√£o usados sem distin√ß√£o, bem como dist√¢ncia, peso e custo.</p> <ul> <li>$n$: n√∫mero de v√©rtices</li> <li>$m$: n√∫mero de arestas</li> <li>$E_{i,j}$: peso da aresta $(i, j)$</li> </ul> <h1 id="os-problemas-enunciados-resumidos">Os problemas (enunciados resumidos)</h1> <ul> <li> <a href="https://cses.fi/problemset/task/1195" rel="external nofollow noopener" target="_blank">Flight Discount (CSES)</a>: grafo direcionado, arcos com peso, $2 \leq n \leq 10^5$, $1 \leq m \leq 2\times10^5$. Encontre o menor caminho do v√©rtice $1$ ao $n$ sendo que voc√™ pode escolher uma aresta $e$ qualquer e mudar seu peso $E_e$ para $\lfloor\frac{E_e}{2}\rfloor$ (s√≥ pode fazer isso uma vez)</li> <li> <a href="https://atcoder.jp/contests/abc325/tasks/abc325_e" rel="external nofollow noopener" target="_blank">Our clients, please wait a moment (AtCoder)</a>: grafo direcionado, arcos com peso, $2 \leq n \leq 1000$, $m = \frac{n(n-1)}{2}$. Encontre o menor caminho do v√©rtice $1$ ao $n$ sendo que, para o caminho escolhido, todos os pesos $E_{i,j}$ valer√£o $E_{i,j}A$ at√© um ponto arbitr√°rio, e a partir da√≠ valer√£o $E_{i,j}B + C$. $1 \leq A, B, C \leq 10^6$</li> <li> <a href="https://codeforces.com/contest/1725/problem/M" rel="external nofollow noopener" target="_blank">Moving Both Hands (Codeforces)</a>: grafo direcionado, arcos com peso, $2 \leq n \leq 10^5$, $0 \leq m \leq 2\times10^5$. Para cada v√©rtice $u &gt; 1$, encontre a menor dist√¢ncia para dois objetos se encontrarem seguindo os arcos, sendo que cada um se move de uma vez, um deles est√° no v√©rtice $1$, e o outro est√° no v√©rtice $u$.</li> </ul> <h1 id="dijkstra">Dijkstra</h1> <p>Nos tr√™s problemas n√≥s usaremos o algoritmo de Dijkstra, ent√£o antes de irmos ao truque (e √†s solu√ß√µes) vamos ver este algoritmo em detalhe.</p> <p>O algoritmo de Dijkstra resolve o problema de caminhos m√≠nimos com origem √∫nica (Single-Source Shortest Paths, SSSP) para grafos com arestas de peso n√£o-negativo. Neste problema, dado um v√©rtice de origem, o objetivo √© encontrar a menor dist√¢ncia para cada um dos outros v√©rtices num caminho que come√ßa na origem.</p> <p>Para as explica√ß√µes a seguir, vamos fixar a origem no v√©rtice $1$.</p> <h2 id="intui√ß√£o">Intui√ß√£o</h2> <p>A ideia intuitiva do algoritmo √©: dado um v√©rtice $u$ que com certeza tem caminho m√≠nimo $w$, para cada aresta $(u, v)$, √© poss√≠vel que o menor caminho de $v$ tenha custo $w+E_{u,v}$. Isso equivaleria a dizer que o caminho m√≠nimo de $v$ passa pela aresta $(u, v)$. Posto de outra forma: para cada cara com caminho m√≠nimo definido, vamos tentar descobrir um novo menor caminho para seus vizinhos.</p> <h2 id="algoritmo">Algoritmo</h2> <p>Vamos guardar duas informa√ß√µes para cada v√©rtice $v$: se ele j√° foi processado e qual a menor dist√¢ncia conhecida de $1$ at√© ele ($d_v$). Inicialmente, $d_1 = 0$ e $d_v = \infty \forall v \neq 1$.</p> <p>Para cada passo do algoritmo, vamos escolher o v√©rtice $v$ com o menor $d_v$ entre aqueles que n√£o foram processados ainda, e ent√£o process√°-lo. Processar um v√©rtice $v$ consiste em relaxar todas as arestas $(v, u)$ com a ideia apresentada na se√ß√£o anterior: $d_u = \min(d_u, d_v+E_{v,u})$.</p> <p>√â f√°cil ver que cada v√©rtice s√≥ √© processado uma vez, porque s√≥ processaremos um v√©rtice que n√£o foi processado. Mas por que √© garantido que, ao processar um v√©rtice, j√° temos o menor valor poss√≠vel de $d_v$?</p> <h3 id="como-funciona">Como funciona</h3> <p>Digamos que seja poss√≠vel que, ap√≥s processar o v√©rtice $v$, relaxemos alguma aresta que diminua o valor $d_v$.</p> <p>Se houvesse arestas negativas, poderia acontecer de inserirmos $v$ num ciclo com soma negativa, e a√≠ seria poss√≠vel tornar $d_v = -\infty$ (veja o grafo abaixo). No nosso problema, n√£o h√° arestas negativas.</p> <div class="jekyll-diagrams diagrams mermaid"> <svg id="mermaid-1700797008015" width="100%" xmlns="http://www.w3.org/2000/svg" style="max-width: 317.140625px;" viewbox="0 0 317.140625 98"><style>#mermaid-1700797008015 .label{font-family:trebuchet ms,verdana,arial;color:#333}#mermaid-1700797008015 .node circle,#mermaid-1700797008015 .node ellipse,#mermaid-1700797008015 .node polygon,#mermaid-1700797008015 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1700797008015 .node.clickable{cursor:pointer}#mermaid-1700797008015 .arrowheadPath{fill:#333}#mermaid-1700797008015 .edgePath .path{stroke:#333;stroke-width:1.5px}#mermaid-1700797008015 .edgeLabel{background-color:#e8e8e8}#mermaid-1700797008015 .cluster rect{fill:#ffffde!important;stroke:#aa3!important;stroke-width:1px!important}#mermaid-1700797008015 .cluster text{fill:#333}#mermaid-1700797008015 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:trebuchet ms,verdana,arial;font-size:12px;background:#ffffde;border:1px solid #aa3;border-radius:2px;pointer-events:none;z-index:100}#mermaid-1700797008015 .actor{stroke:#ccf;fill:#ececff}#mermaid-1700797008015 text.actor{fill:#000;stroke:none}#mermaid-1700797008015 .actor-line{stroke:grey}#mermaid-1700797008015 .messageLine0{marker-end:"url(#arrowhead)"}#mermaid-1700797008015 .messageLine0,#mermaid-1700797008015 .messageLine1{stroke-width:1.5;stroke-dasharray:"2 2";stroke:#333}#mermaid-1700797008015 #arrowhead{fill:#333}#mermaid-1700797008015 #crosshead path{fill:#333!important;stroke:#333!important}#mermaid-1700797008015 .messageText{fill:#333;stroke:none}#mermaid-1700797008015 .labelBox{stroke:#ccf;fill:#ececff}#mermaid-1700797008015 .labelText,#mermaid-1700797008015 .loopText{fill:#000;stroke:none}#mermaid-1700797008015 .loopLine{stroke-width:2;stroke-dasharray:"2 2";marker-end:"url(#arrowhead)";stroke:#ccf}#mermaid-1700797008015 .note{stroke:#aa3;fill:#fff5ad}#mermaid-1700797008015 .noteText{fill:#000;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:14px}#mermaid-1700797008015 .section{stroke:none;opacity:.2}#mermaid-1700797008015 .section0{fill:rgba(102,102,255,.49)}#mermaid-1700797008015 .section2{fill:#fff400}#mermaid-1700797008015 .section1,#mermaid-1700797008015 .section3{fill:#fff;opacity:.2}#mermaid-1700797008015 .sectionTitle0,#mermaid-1700797008015 .sectionTitle1,#mermaid-1700797008015 .sectionTitle2,#mermaid-1700797008015 .sectionTitle3{fill:#333}#mermaid-1700797008015 .sectionTitle{text-anchor:start;font-size:11px;text-height:14px}#mermaid-1700797008015 .grid .tick{stroke:#d3d3d3;opacity:.3;shape-rendering:crispEdges}#mermaid-1700797008015 .grid path{stroke-width:0}#mermaid-1700797008015 .today{fill:none;stroke:red;stroke-width:2px}#mermaid-1700797008015 .task{stroke-width:2}#mermaid-1700797008015 .taskText{text-anchor:middle;font-size:11px}#mermaid-1700797008015 .taskTextOutsideRight{fill:#000;text-anchor:start;font-size:11px}#mermaid-1700797008015 .taskTextOutsideLeft{fill:#000;text-anchor:end;font-size:11px}#mermaid-1700797008015 .taskText0,#mermaid-1700797008015 .taskText1,#mermaid-1700797008015 .taskText2,#mermaid-1700797008015 .taskText3{fill:#fff}#mermaid-1700797008015 .task0,#mermaid-1700797008015 .task1,#mermaid-1700797008015 .task2,#mermaid-1700797008015 .task3{fill:#8a90dd;stroke:#534fbc}#mermaid-1700797008015 .taskTextOutside0,#mermaid-1700797008015 .taskTextOutside1,#mermaid-1700797008015 .taskTextOutside2,#mermaid-1700797008015 .taskTextOutside3{fill:#000}#mermaid-1700797008015 .active0,#mermaid-1700797008015 .active1,#mermaid-1700797008015 .active2,#mermaid-1700797008015 .active3{fill:#bfc7ff;stroke:#534fbc}#mermaid-1700797008015 .activeText0,#mermaid-1700797008015 .activeText1,#mermaid-1700797008015 .activeText2,#mermaid-1700797008015 .activeText3{fill:#000!important}#mermaid-1700797008015 .done0,#mermaid-1700797008015 .done1,#mermaid-1700797008015 .done2,#mermaid-1700797008015 .done3{stroke:grey;fill:#d3d3d3;stroke-width:2}#mermaid-1700797008015 .doneText0,#mermaid-1700797008015 .doneText1,#mermaid-1700797008015 .doneText2,#mermaid-1700797008015 .doneText3{fill:#000!important}#mermaid-1700797008015 .crit0,#mermaid-1700797008015 .crit1,#mermaid-1700797008015 .crit2,#mermaid-1700797008015 .crit3{stroke:#f88;fill:red;stroke-width:2}#mermaid-1700797008015 .activeCrit0,#mermaid-1700797008015 .activeCrit1,#mermaid-1700797008015 .activeCrit2,#mermaid-1700797008015 .activeCrit3{stroke:#f88;fill:#bfc7ff;stroke-width:2}#mermaid-1700797008015 .doneCrit0,#mermaid-1700797008015 .doneCrit1,#mermaid-1700797008015 .doneCrit2,#mermaid-1700797008015 .doneCrit3{stroke:#f88;fill:#d3d3d3;stroke-width:2;cursor:pointer;shape-rendering:crispEdges}#mermaid-1700797008015 .activeCritText0,#mermaid-1700797008015 .activeCritText1,#mermaid-1700797008015 .activeCritText2,#mermaid-1700797008015 .activeCritText3,#mermaid-1700797008015 .doneCritText0,#mermaid-1700797008015 .doneCritText1,#mermaid-1700797008015 .doneCritText2,#mermaid-1700797008015 .doneCritText3{fill:#000!important}#mermaid-1700797008015 .titleText{text-anchor:middle;font-size:18px;fill:#000}
#mermaid-1700797008015 g.classGroup text{fill:#9370db;stroke:none;font-family:trebuchet ms,verdana,arial;font-size:10px}#mermaid-1700797008015 g.classGroup rect{fill:#ececff;stroke:#9370db}#mermaid-1700797008015 g.classGroup line{stroke:#9370db;stroke-width:1}#mermaid-1700797008015 .classLabel .box{stroke:none;stroke-width:0;fill:#ececff;opacity:.5}#mermaid-1700797008015 .classLabel .label{fill:#9370db;font-size:10px}#mermaid-1700797008015 .relation{stroke:#9370db;stroke-width:1;fill:none}#mermaid-1700797008015 #compositionEnd,#mermaid-1700797008015 #compositionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1700797008015 #aggregationEnd,#mermaid-1700797008015 #aggregationStart{fill:#ececff;stroke:#9370db;stroke-width:1}#mermaid-1700797008015 #dependencyEnd,#mermaid-1700797008015 #dependencyStart,#mermaid-1700797008015 #extensionEnd,#mermaid-1700797008015 #extensionStart{fill:#9370db;stroke:#9370db;stroke-width:1}#mermaid-1700797008015 .branch-label,#mermaid-1700797008015 .commit-id,#mermaid-1700797008015 .commit-msg{fill:#d3d3d3;color:#d3d3d3}</style> <style>#mermaid-1700797008015{color:#000;font:normal normal 400 normal 16px / normal "Times New Roman"}</style> <g transform="translate(-12, -12)"><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath" style="opacity: 1;"><path class="path" d="M48.90625,57.019417475728154L77.90625,39L106.90625,39" marker-end="url(#arrowhead27)" style="fill:none"></path><defs><marker id="arrowhead27" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M135.8125,39L171.4765625,39L207.140625,39" marker-end="url(#arrowhead28)" style="fill:none"></path><defs><marker id="arrowhead28" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M235.140625,39L264.140625,39L293.140625,57.2093023255814" marker-end="url(#arrowhead29)" style="fill:none"></path><defs><marker id="arrowhead29" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath" style="opacity: 1;"><path class="path" d="M293.140625,74.79069767441861L264.140625,93L221.140625,93L171.4765625,93L121.359375,93L77.90625,93L48.90625,74.98058252427184" marker-end="url(#arrowhead30)" style="fill:none"></path><defs><marker id="arrowhead30" viewbox="0 0 10 10" refx="9" refy="5" markerunits="strokeWidth" markerwidth="8" markerheight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform="translate(77.90625,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">2</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(171.4765625,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">2</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(264.140625,39)"><g transform="translate(-4,-9)" class="label"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">1</span></div></foreignobject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(171.4765625,93)"><g transform="translate(-10.6640625,-9)" class="label"><foreignobject width="21.328125" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span class="edgeLabel">-10</span></div></foreignobject></g></g></g><g class="nodes"><g class="node" id="1" transform="translate(34.453125,66)" style="opacity: 1;"><rect rx="0" ry="0" x="-14.453125" y="-19" width="28.90625" height="38"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">1</div></foreignobject></g></g></g><g class="node" id="b" transform="translate(121.359375,39)" style="opacity: 1;"><rect rx="0" ry="0" x="-14.453125" y="-19" width="28.90625" height="38"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4.453125,-9)"><foreignobject width="8.90625" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">b</div></foreignobject></g></g></g><g class="node" id="v" transform="translate(221.140625,39)" style="opacity: 1;"><rect rx="0" ry="0" x="-14" y="-19" width="28" height="38"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4,-9)"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">v</div></foreignobject></g></g></g><g class="node" id="x" transform="translate(307.140625,66)" style="opacity: 1;"><rect rx="0" ry="0" x="-14" y="-19" width="28" height="38"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-4,-9)"><foreignobject width="8" height="18"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">x</div></foreignobject></g></g></g></g></g></g></svg> </div> <p>Como n√£o h√° arestas negativas, o √∫nico jeito √© se encontrarmos algum v√©rtice $u$ com $d_u &lt; d_v$, onde h√° um caminho de $u$ at√© $v$ com peso $x$ tal que $d_u + x &lt; d_v$. No entanto, como processamos sempre o v√©rtice com menor dist√¢ncia primeiro, e como $d_u &lt; d_v$, n√≥s ter√≠amos processado $u$ antes de $v$.</p> <p>Portanto, ao processar o v√©rtice $v$, <strong>j√° conhecemos o menor valor poss√≠vel para $d_v$.</strong></p> <h3 id="complexidade---observa√ß√µes">Complexidade - observa√ß√µes</h3> <p>Agora, qual ser√° a complexidade desse algoritmo? Come√ßaremos por algumas observa√ß√µes.</p> <h4 id="observa√ß√£o-1-cada-v√©rtice-√©-processado-uma-vez">Observa√ß√£o 1: cada v√©rtice √© processado uma vez</h4> <p>Cada v√©rtice √© processado apenas uma vez, porque n√£o processamos v√©rtices que j√° foram processados. Isso implica em um termo $\mathcal{O}(n)$ em algum lugar na complexidade final.</p> <h4 id="observa√ß√£o-2-cada-aresta-√©-relaxada-uma-vez">Observa√ß√£o 2: cada aresta √© relaxada uma vez</h4> <p>N√≥s relaxaremos uma aresta $(u, v)$ sempre que processarmos o v√©rtice de origem $u$, ou seja, uma vez. Isso implica em um termo $+\mathcal{O}(m)$ em algum lugar na complexidade final (separado do termo anterior).</p> <p>Ignorando as complexidades de escolher o pr√≥ximo v√©rtice a processar e de relaxar uma aresta, temos uma complexidade de $\mathcal{O}(n+m)$.</p> <h4 id="complexidade-e-c√≥digo-para-grafos-densos">Complexidade e c√≥digo para grafos densos</h4> <p>Em grafos densos, o n√∫mero de arestas √© pr√≥ximo do m√°ximo ($\frac{n(n-1)}{2}$). Se guardamos em um vetor booleano $m$ quais v√©rtices j√° foram processados, podemos a cada itera√ß√£o do algoritmo buscar o pr√≥ximo v√©rtice a ser processado em $\mathcal{O}(n)$, relaxando cada aresta em $\mathcal{O}(1)$. Isso significa uma complexidade $\mathcal{O}(n^2 + m) = \mathcal{O}(n^2)$. Para grafos densos, essa complexidade √© √≥tima. Abaixo deixo uma implementa√ß√£o do algoritmo nesse caso:</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">ii</span> <span class="o">=</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ii</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mh">0x3f3f3f3f</span><span class="p">),</span> <span class="n">m</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">);</span>
	<span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
		<span class="c1">// escolhe o pr√≥ximo</span>
		<span class="kt">int</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span><span class="n">j</span><span class="p">)</span>
			<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">m</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">||</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">d</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
				<span class="n">v</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
		<span class="c1">// processa</span>
		<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">]</span><span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
			<span class="c1">// relaxa aresta (v, u)</span>
			<span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">+</span><span class="n">x</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h4 id="complexidade-e-c√≥digo-para-grafos-esparsos">Complexidade e c√≥digo para grafos esparsos</h4> <p>Quando o n√∫mero de arestas √© muito menor que o m√°ximo poss√≠vel, existe uma varia√ß√£o com desempenho melhor. O que vamos fazer √© guardar em uma estrutura que permita inser√ß√£o de valores e remo√ß√£o de m√≠nimo em tempo logar√≠tmico, e guardar nela pares $(d_v, v)$.</p> <p>A melhoria dessa varia√ß√£o √© que a sele√ß√£o do pr√≥ximo v√©rtice a processar ter√° custo logar√≠tmico, j√° que basta selecionar o menor par na estrutura.</p> <p>Ao mesmo tempo, relaxar uma aresta deixar√° de ser constante, porque ao encontrar um peso menor para o v√©rtice $u$ n√≥s teremos de adicion√°-lo √† estrutura em tempo logar√≠tmico.</p> <p>Com essa altera√ß√£o, a complexidade do algoritmo passa a ser $\mathcal{O}(n\log n + m\log n)$, que √© muito melhor que a anterior no caso de grafos esparsos.</p> <p>A implementa√ß√£o abaixo usa uma fila de prioridade, mas outras estruturas apresentam a mesma complexidade. Com uma <em>fibonacci heap</em> √© poss√≠vel atingir tempo constante na inser√ß√£o e logar√≠tmico na remo√ß√£o, mas como ela √© muito mais dif√≠cil de implementar, n√£o √© t√£o adequada para programa√ß√£o competitiva.</p> <div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">using</span> <span class="n">ii</span> <span class="o">=</span> <span class="n">pair</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">,</span> <span class="kt">int</span><span class="o">&gt;</span><span class="p">;</span>
<span class="kt">void</span> <span class="nf">dijkstra</span><span class="p">(</span><span class="kt">int</span> <span class="n">s</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">ii</span><span class="o">&gt;&gt;</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">const</span> <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">g</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
	<span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">d</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mh">0x3f3f3f3f</span><span class="p">);</span>
	<span class="n">priority_queue</span><span class="o">&lt;</span><span class="n">ii</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="n">ii</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">greater</span><span class="o">&lt;</span><span class="n">ii</span><span class="o">&gt;&gt;</span> <span class="n">pq</span><span class="p">;</span>
	<span class="n">pq</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
	<span class="k">while</span> <span class="p">(</span><span class="n">pq</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="p">{</span>
		<span class="c1">// escolhe o pr√≥ximo</span>
		<span class="k">auto</span> <span class="p">[</span><span class="n">w</span><span class="p">,</span> <span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">pq</span><span class="p">.</span><span class="n">top</span><span class="p">();</span> <span class="n">pq</span><span class="p">.</span><span class="n">pop</span><span class="p">();</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">w</span> <span class="o">!=</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">])</span> <span class="c1">// descarta pares desatualizados</span>
			<span class="k">continue</span><span class="p">;</span>
		<span class="c1">// processa</span>
		<span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">]</span><span class="o">:</span> <span class="n">g</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
			<span class="c1">// relaxa aresta (v, u)</span>
			<span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">w</span><span class="o">+</span><span class="n">x</span><span class="p">)</span>
				<span class="n">pq</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">w</span><span class="o">+</span><span class="n">x</span><span class="p">),</span> <span class="n">u</span><span class="p">);</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h1 id="truque-do-grafo-duplicado">Truque do grafo duplicado</h1> <p>‚Ä¶</p> <h1 id="solu√ß√µes-com-o-truque">Solu√ß√µes com o truque</h1> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> <d-bibliography src="/assets/bibliography/"></d-bibliography> </div> <footer class="sticky-bottom mt-5"> <div class="container"> ¬© Copyright 2023 Raul G. P. de Almeida. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>